<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta name="viewport"
		content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no">
	<meta http-equiv="X-UA-Compatible" content="ie=edge">
	<title>弹幕测试</title>
	<style>
		html, body {
			margin: 0;
			padding: 0;
		}
		.danmu-content {
			margin: 30px 10px;
			height: 180px;
			border: 1px solid;
		}

		.opeate button {
			margin: 10px;
			border: 1px solid;
		}
		.screen {
			/* width: 100vw; */
			height: 100%;
		}
		.danmu-item {
			margin: 5px;
			border: 1px solid;
			overflow: hidden;
			display: inline-block;
			word-break: keep-all; 
			white-space: nowrap;
		}
	</style>
</head>

<body>
	<div id="root">
		<div class="app">
			<h1>弹幕开发</h1>
			<div class="danmu-content">
				<div class="screen"></div>
				<div class="opeate">
					<button onClick={this.handleSend}>手动发送1</button>
					<button onClick={this.handleSend2}>手动发送2</button>
				</div>
				<div class="opeate">
					<button onClick={this.pause}>暂停全部</button>
					<button onClick={this.continue}>继续全部</button>
				</div>
				<div class="opeate">
					<button class="close-time">暂停计时器</button>
					<button class="open-time" >继续计时器</button>
				</div>
			</div>
		</div>
	</div>
</body>
<script src="danmujs.min.js"></script>
<script>
	const danmuTest = {
		screen: null,
		handler: null,
		dom: {
			closeTime: document.querySelector('.close-time'),
			openTime: document.querySelector('.open-time'),
		},
		init() {
			this.eventInit();
			this.screen = new Danmujs('.screen', {
				trackHeight: 35,
				speed: 80,
				pauseOnClick: true,
			});
			this.sendDanmu();
		},
		sendDanmu() {
			this.sendAction();
		},
		sendAction () {
			this.handler = setInterval(() => {
				const dom = `<span class="danmu-item">你好科比布莱恩特</span>`
				console.log('push --->执行')
				this.screen.push(dom)
			}, 500);
		},
		// 暂停
		pause() {
			this.screen.pause()
		},
		// 继续
		continue() {
			this.screen.resume()
		},
		closeTime() {
			console.log('closeTime--->')
			this.handler && clearInterval(this.handler)
		},
		eventInit() {
			console.log(this.dom.closeTime)
			this.dom.closeTime.addEventListener('click', () => {
				this.closeTime()
			})
			this.dom.openTime.addEventListener('click', () => {
				this.sendDanmu()
			})
		}
	}

	danmuTest.init()
</script>

</html>